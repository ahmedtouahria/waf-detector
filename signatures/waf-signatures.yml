version: "1.0"

signatures:
  # Cloudflare WAF
  - name: "Cloudflare"
    enabled: true
    description: "Cloudflare Web Application Firewall"
    vendor: "Cloudflare"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "CF-Ray"
        condition: exists
        confidence: 0.35
      - type: header
        key: "CF-Cache-Status"
        condition: exists
        confidence: 0.25
      - type: header
        key: "CF-Request-ID"
        condition: exists
        confidence: 0.2
      - type: header
        key: "Server"
        condition: contains
        value: "cloudflare"
        case_insensitive: true
        confidence: 0.3
      - type: cookie
        key: "__cfduid"
        condition: contains
        confidence: 0.25
      - type: cookie
        key: "cf_clearance"
        condition: contains
        confidence: 0.25
      - type: body
        condition: contains
        values: ["attention required", "cloudflare", "ray id:", "cf-ray"]
        case_insensitive: true
        status_codes: [403, 503]
        confidence: 0.3
      - type: body
        condition: contains
        values: ["checking your browser", "ddos protection by cloudflare"]
        case_insensitive: true
        confidence: 0.25
      - type: header
        key: "CF-Team"
        condition: exists
        confidence: 0.15
      - type: header
        key: "Expect-CT"
        condition: exists
        confidence: 0.15

  # AWS WAF
  - name: "AWS WAF"
    enabled: true
    description: "Amazon Web Services Web Application Firewall"
    vendor: "Amazon"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-AMZ-ID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-AMZ-Request-ID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-AMZN-RequestID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-AMZN-Trace-ID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-AMZ-CF-ID"
        condition: exists
        confidence: 0.3
      - type: header
        key: "Server"
        condition: contains
        values: ["awselb", "aws", "amazon"]
        case_insensitive: true
        confidence: 0.25
      - type: body
        condition: contains
        values: ["request blocked", "aws waf", "requestid"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3
      - type: body
        condition: contains
        value: "aws waf"
        case_insensitive: true
        confidence: 0.35

  # Akamai
  - name: "Akamai"
    enabled: true
    description: "Akamai Web Application Protector"
    vendor: "Akamai"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "akamaighost"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-Akamai-Session-Info"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        value: "akamai"
        case_insensitive: true
        confidence: 0.25

  # Imperva Incapsula
  - name: "Imperva Incapsula"
    enabled: true
    description: "Imperva Incapsula Web Application Firewall"
    vendor: "Imperva"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-CDN"
        condition: contains
        value: "incapsula"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-Iinfo"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        values: ["incapsula", "imperva"]
        case_insensitive: true
        confidence: 0.25

  # F5 BIG-IP
  - name: "F5 BIG-IP"
    enabled: true
    description: "F5 BIG-IP Application Security Manager"
    vendor: "F5 Networks"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        values: ["bigip", "f5"]
        case_insensitive: true
        confidence: 0.4
      - type: cookie
        key: "TS"
        condition: contains
        status_codes: [403]
        confidence: 0.3

  # ModSecurity
  - name: "ModSecurity"
    enabled: true
    description: "ModSecurity Open Source WAF"
    vendor: "Trustwave"
    category: "opensource"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        values: ["mod_security", "modsecurity"]
        case_insensitive: true
        confidence: 0.4
      - type: body
        condition: contains
        values: ["mod_security", "modsecurity", "not acceptable"]
        case_insensitive: true
        status_codes: [406, 403, 501]
        confidence: 0.35
      - type: body
        condition: contains
        values: ["reference id", "your access has been blocked"]
        case_insensitive: true
        confidence: 0.25

  # Sucuri CloudProxy
  - name: "Sucuri CloudProxy WAF"
    enabled: true
    description: "Sucuri Website Firewall"
    vendor: "Sucuri"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "sucuri"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-Sucuri-ID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-Sucuri-Cache"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        values: ["sucuri", "cloudproxy", "access denied - sucuri website firewall"]
        case_insensitive: true
        confidence: 0.3
      - type: cookie
        key: "sucuri"
        condition: contains
        confidence: 0.25

  # Wordfence
  - name: "Wordfence"
    enabled: true
    description: "Wordfence WordPress Security Plugin"
    vendor: "Defiant"
    category: "plugin"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: body
        condition: contains
        values: ["wordfence", "generated by wordfence", "a potentially unsafe operation has been detected"]
        case_insensitive: true
        confidence: 0.4
      - type: body
        condition: contains
        value: "this site is currently unavailable"
        case_insensitive: true
        status_codes: [503]
        confidence: 0.25
      - type: cookie
        key: "wfvt_"
        condition: contains
        confidence: 0.35

  # Azure WAF
  - name: "Azure WAF"
    enabled: true
    description: "Microsoft Azure Web Application Firewall"
    vendor: "Microsoft"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Azure-Ref"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-Azure-SocketIP"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Server"
        condition: contains
        value: "azure"
        case_insensitive: true
        confidence: 0.25
      - type: body
        condition: contains
        values: ["azure", "microsoft azure"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3

  # Fastly WAF
  - name: "Fastly WAF"
    enabled: true
    description: "Fastly Web Application Firewall"
    vendor: "Fastly"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Fastly-Request-ID"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Fastly-Debug-Digest"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Via"
        condition: contains
        value: "fastly"
        case_insensitive: true
        confidence: 0.3
      - type: header
        key: "Server"
        condition: contains
        value: "fastly"
        case_insensitive: true
        confidence: 0.25

  # Wallarm
  - name: "Wallarm"
    enabled: true
    description: "Wallarm AI-Powered WAF"
    vendor: "Wallarm"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "wallarm"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "Via"
        condition: contains
        value: "wallarm"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        value: "wallarm"
        case_insensitive: true
        confidence: 0.3
      - type: body
        condition: contains
        value: "request blocked"
        case_insensitive: true
        status_codes: [403]
        confidence: 0.2

  # Google Cloud Armor
  - name: "Google Cloud Armor"
    enabled: true
    description: "Google Cloud Armor WAF"
    vendor: "Google Cloud"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Cloud-Trace-Context"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Via"
        condition: contains
        value: "google"
        case_insensitive: true
        confidence: 0.25
      - type: body
        condition: contains
        values: ["google cloud armor", "error 403", "access denied"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3
      - type: header
        key: "Server"
        condition: contains
        value: "ghs"
        case_insensitive: true
        confidence: 0.25

  # Barracuda WAF
  - name: "Barracuda WAF"
    enabled: true
    description: "Barracuda Web Application Firewall"
    vendor: "Barracuda Networks"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: cookie
        key: "barra_counter_session"
        condition: contains
        confidence: 0.45
      - type: cookie
        key: "BNI__BARRACUDA_LB_COOKIE"
        condition: contains
        confidence: 0.4
      - type: body
        condition: contains
        value: "barracuda"
        case_insensitive: true
        confidence: 0.3
      - type: header
        key: "X-Barracuda-"
        condition: exists
        confidence: 0.35

  # Fortinet FortiWeb
  - name: "FortiWeb"
    enabled: true
    description: "Fortinet FortiWeb Web Application Firewall"
    vendor: "Fortinet"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: cookie
        key: "FORTIWAFSID"
        condition: contains
        confidence: 0.45
      - type: body
        condition: contains
        values: ["fortiweb", "fortigate"]
        case_insensitive: true
        confidence: 0.35
      - type: header
        key: "Server"
        condition: contains
        value: "fortiweb"
        case_insensitive: true
        confidence: 0.4

  # Citrix NetScaler AppFirewall
  - name: "Citrix NetScaler"
    enabled: true
    description: "Citrix NetScaler Application Firewall"
    vendor: "Citrix Systems"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: cookie
        key: "ns_af"
        condition: contains
        confidence: 0.4
      - type: cookie
        key: "citrix_ns_id"
        condition: contains
        confidence: 0.4
      - type: header
        key: "Via"
        condition: contains
        value: "NS-CACHE"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        value: "netscaler"
        case_insensitive: true
        confidence: 0.25
      - type: cookie
        key: "NSC_"
        condition: contains
        confidence: 0.3

  # Reblaze WAF
  - name: "Reblaze"
    enabled: true
    description: "Reblaze Cloud-Based WAF"
    vendor: "Reblaze"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Reblaze-Request-ID"
        condition: exists
        confidence: 0.45
      - type: header
        key: "Server"
        condition: contains
        value: "reblaze"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        values: ["reblaze", "rbzid"]
        case_insensitive: true
        confidence: 0.3

  # Radware Cloud WAF
  - name: "Radware AppWall"
    enabled: true
    description: "Radware AppWall Web Application Firewall"
    vendor: "Radware"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-ADC-"
        condition: exists
        confidence: 0.35
      - type: cookie
        key: "visid_incap"
        condition: contains
        confidence: 0.3
      - type: body
        condition: contains
        values: ["radware", "appwall"]
        case_insensitive: true
        confidence: 0.35
      - type: header
        key: "Server"
        condition: contains
        value: "radware"
        case_insensitive: true
        confidence: 0.4

  # Palo Alto Prisma Cloud WAAS
  - name: "Prisma Cloud WAAS"
    enabled: true
    description: "Palo Alto Prisma Cloud Web Application and API Security"
    vendor: "Palo Alto Networks"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Prisma-"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        values: ["prisma cloud", "twistlock", "request blocked"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3
      - type: header
        key: "X-Twistlock-"
        condition: exists
        confidence: 0.35

  # Check Point CloudGuard WAF
  - name: "CloudGuard WAF"
    enabled: true
    description: "Check Point CloudGuard Web Application Firewall"
    vendor: "Check Point"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: cookie
        key: "cp_"
        condition: contains
        confidence: 0.35
      - type: header
        key: "X-CV-"
        condition: exists
        confidence: 0.3
      - type: body
        condition: contains
        values: ["cloudguard", "check point", "access denied"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3
      - type: header
        key: "Server"
        condition: contains
        values: ["cloudguard", "checkpoint"]
        case_insensitive: true
        confidence: 0.35

  # DataDome Bot Protection
  - name: "DataDome"
    enabled: true
    description: "DataDome Bot Protection and WAF"
    vendor: "DataDome"
    category: "service"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: cookie
        key: "datadome"
        condition: contains
        confidence: 0.45
      - type: header
        key: "X-DataDome"
        condition: exists
        confidence: 0.4
      - type: header
        key: "Server"
        condition: contains
        value: "datadome"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        values: ["datadome", "captcha", "bot detection"]
        case_insensitive: true
        status_codes: [403, 405]
        confidence: 0.3

  # Kasada Bot Defense
  - name: "Kasada"
    enabled: true
    description: "Kasada Bot Defense Platform"
    vendor: "Kasada"
    category: "service"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "x-kpsdk-ct"
        condition: exists
        confidence: 0.45
      - type: header
        key: "x-kpsdk-"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        value: "kasada"
        case_insensitive: true
        confidence: 0.35
      - type: header
        key: "x-kpsdk-v"
        condition: exists
        confidence: 0.35

  # StackPath WAF
  - name: "StackPath"
    enabled: true
    description: "StackPath Edge Security WAF"
    vendor: "StackPath"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-SP-Shield"
        condition: exists
        confidence: 0.4
      - type: header
        key: "X-StackPath-Shield"
        condition: exists
        confidence: 0.4
      - type: header
        key: "Server"
        condition: contains
        value: "stackpath"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        value: "stackpath"
        case_insensitive: true
        confidence: 0.25

  # Gcore WAF
  - name: "Gcore WAF"
    enabled: true
    description: "Gcore Web Application Firewall"
    vendor: "Gcore"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Gcore-Cache"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Server"
        condition: contains
        value: "gcore"
        case_insensitive: true
        confidence: 0.35
      - type: body
        condition: contains
        values: ["gcore", "access denied"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.3
      - type: header
        key: "X-Gcore-"
        condition: exists
        confidence: 0.3

  # 360PanYun
  - name: "360PanYun"
    enabled: true
    description: "360 Technologies PanYun WAF"
    vendor: "360 Technologies"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Powered-By-360WZB"
        condition: exists
        confidence: 0.45
      - type: header
        key: "X-WZWS-RAY"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        values: ["360panyun", "360wzb"]
        case_insensitive: true
        confidence: 0.35
      - type: cookie
        key: "qianxin"
        condition: contains
        confidence: 0.3

  # 360WangZhanBao
  - name: "360WangZhanBao"
    enabled: true
    description: "360 Technologies WangZhanBao (Website Protector)"
    vendor: "360 Technologies"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Powered-By-360WZB"
        condition: exists
        confidence: 0.45
      - type: header
        key: "wangzhanbaoCN"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        values: ["360wzb", "wangzhan bao", "360 website security"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.35
      - type: cookie
        key: "wzws"
        condition: contains
        confidence: 0.3

  # ACE XML Gateway
  - name: "ACE XML Gateway"
    enabled: true
    description: "Cisco ACE XML Gateway"
    vendor: "Cisco"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        values: ["ACE XML Gateway", "cisco-ace"]
        case_insensitive: true
        confidence: 0.45
      - type: body
        condition: contains
        values: ["ace xml gateway", "cisco ace"]
        case_insensitive: true
        confidence: 0.35

  # ASP.NET Generic
  - name: "ASP.NET Generic Protection"
    enabled: true
    description: "Microsoft ASP.NET Generic Error Protection"
    vendor: "Microsoft"
    category: "framework"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-AspNet-Version"
        condition: exists
        confidence: 0.3
      - type: header
        key: "X-Powered-By"
        condition: contains
        value: "ASP.NET"
        case_insensitive: true
        confidence: 0.25
      - type: body
        condition: contains
        values: ["runtime error", "server error in", "asp.net"]
        case_insensitive: true
        status_codes: [500, 403]
        confidence: 0.35

  # ASPA Firewall
  - name: "ASPA Firewall"
    enabled: true
    description: "ASPA Engineering Web Application Firewall"
    vendor: "ASPA Engineering Co."
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-ASPA-ID"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        values: ["aspa firewall", "aspa engineering"]
        case_insensitive: true
        confidence: 0.4

  # AWS Elastic Load Balancer
  - name: "AWS Elastic Load Balancer"
    enabled: true
    description: "Amazon Elastic Load Balancer"
    vendor: "Amazon"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        values: ["awselb", "elb"]
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-AMZ-"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        values: ["elastic load balancing", "elb"]
        case_insensitive: true
        confidence: 0.3

  # AireeCDN
  - name: "AireeCDN"
    enabled: true
    description: "Airee CDN and WAF"
    vendor: "Airee"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "airee"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-Airee"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        value: "airee"
        case_insensitive: true
        confidence: 0.3

  # Airlock
  - name: "Airlock"
    enabled: true
    description: "Phion/Ergon Airlock WAF"
    vendor: "Phion/Ergon"
    category: "appliance"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "airlock"
        case_insensitive: true
        confidence: 0.45
      - type: cookie
        key: "AL_SESS"
        condition: contains
        confidence: 0.4
      - type: cookie
        key: "AL-LB"
        condition: contains
        confidence: 0.4
      - type: body
        condition: contains
        values: ["airlock", "ergon"]
        case_insensitive: true
        confidence: 0.35

  # Alert Logic
  - name: "Alert Logic"
    enabled: true
    description: "Alert Logic Web Application Firewall"
    vendor: "Alert Logic"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-AlertLogic"
        condition: exists
        confidence: 0.45
      - type: header
        key: "X-ALERTLOGIC-"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        values: ["alert logic", "alertlogic"]
        case_insensitive: true
        confidence: 0.35

  # AliYunDun
  - name: "AliYunDun"
    enabled: true
    description: "Alibaba Cloud Computing AliYunDun WAF"
    vendor: "Alibaba Cloud Computing"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Alicdn-Cache-Status"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Ali-Swift-Global-Savetime"
        condition: exists
        confidence: 0.35
      - type: header
        key: "Server"
        condition: contains
        values: ["aliyun", "alibaba"]
        case_insensitive: true
        confidence: 0.3
      - type: body
        condition: contains
        values: ["aliyundun", "aliyun", "error by aliyun"]
        case_insensitive: true
        status_codes: [403, 405]
        confidence: 0.35

  # AnYu
  - name: "AnYu"
    enabled: true
    description: "AnYu Technologies WAF"
    vendor: "AnYu Technologies"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-AnYu"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        values: ["anyu", "anyu technologies"]
        case_insensitive: true
        confidence: 0.4

  # Anquanbao
  - name: "Anquanbao"
    enabled: true
    description: "Anquanbao Web Application Firewall"
    vendor: "Anquanbao"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Anquanbao"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        value: "anquanbao"
        case_insensitive: true
        confidence: 0.4
      - type: cookie
        key: "aqb_"
        condition: contains
        confidence: 0.35

  # Armor Defense
  - name: "Armor Defense"
    enabled: true
    description: "Armor Defense Web Application Firewall"
    vendor: "Armor"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Armor-"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        values: ["armor defense", "armor.com"]
        case_insensitive: true
        confidence: 0.35

  # ArvanCloud
  - name: "ArvanCloud"
    enabled: true
    description: "ArvanCloud CDN and WAF"
    vendor: "ArvanCloud"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "arvancloud"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "AR-PoweredBy"
        condition: exists
        confidence: 0.45
      - type: cookie
        key: "__arcsession"
        condition: contains
        confidence: 0.35
      - type: body
        condition: contains
        values: ["arvancloud", "arvan"]
        case_insensitive: true
        confidence: 0.3

  # Astra
  - name: "Astra"
    enabled: true
    description: "Czar Securities Astra WAF"
    vendor: "Czar Securities"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Astra-"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        values: ["astra security", "blocked by astra"]
        case_insensitive: true
        status_codes: [403]
        confidence: 0.4
      - type: cookie
        key: "astra"
        condition: contains
        confidence: 0.35

  # Azion Edge Firewall
  - name: "Azion Edge Firewall"
    enabled: true
    description: "Azion Edge Computing Platform Firewall"
    vendor: "Azion"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "Server"
        condition: contains
        value: "azion"
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-Azion-"
        condition: exists
        confidence: 0.45
      - type: body
        condition: contains
        values: ["azion", "edge firewall"]
        case_insensitive: true
        confidence: 0.35

  # Azure Application Gateway
  - name: "Azure Application Gateway"
    enabled: true
    description: "Microsoft Azure Application Gateway"
    vendor: "Microsoft"
    category: "cloud"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Azure-Ref"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-AppGW-"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        values: ["azure application gateway", "application gateway"]
        case_insensitive: true
        status_codes: [403, 502]
        confidence: 0.35

  # Azure Front Door
  - name: "Azure Front Door"
    enabled: true
    description: "Microsoft Azure Front Door"
    vendor: "Microsoft"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-Azure-Ref"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-Azure-OriginStatusCode"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-Azure-ExternalError"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-FD-"
        condition: exists
        confidence: 0.4
      - type: body
        condition: contains
        values: ["azure front door", "frontdoor"]
        case_insensitive: true
        confidence: 0.3

  # Verizon Digital Media WAF
  - name: "Verizon Digital Media"
    enabled: true
    description: "Verizon Digital Media Services (EdgeCast) WAF"
    vendor: "Verizon Media"
    category: "cdn"
    minimum_indicators: 2
    confidence_multiplier: 0.5
    indicators:
      - type: header
        key: "X-EC-Custom-Error"
        condition: exists
        confidence: 0.45
      - type: header
        key: "Server"
        condition: contains
        values: ["ECAcc", "ECD", "edgecast"]
        case_insensitive: true
        confidence: 0.4
      - type: header
        key: "X-EdgeConnect-MidMile-RTT"
        condition: exists
        confidence: 0.35
      - type: header
        key: "X-EdgeConnect-Origin-MEX-Latency"
        condition: exists
        confidence: 0.35
      - type: body
        condition: contains
        values: ["edgecast", "verizon digital media", "reference number"]
        case_insensitive: true
        status_codes: [403, 400]
        confidence: 0.3
      - type: header
        key: "X-EC-Debug"
        condition: exists
        confidence: 0.3
      - type: cookie
        key: "_ec_"
        condition: contains
        confidence: 0.25
